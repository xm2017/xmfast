
<site>
  <packgetName>com.191ysw</packgetName>
  <minApi>1</minApi>
  <author name="noName" avatarUrl="" description="大神在此" donateUrl=""/>

  <info type="801" versionCode="001" versionName="v1.0" name="191影视屋" description="资源还不错啊"
        iconUrl="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1536516263810&di=3536438ba38de3ae3b59e89ad6d73bc6&imgtype=0&src=http%3A%2F%2Fimage.yy.com%2Fyywebalbumbs2bucket%2Fd8be68cf098e472eb5e1295524f00359_1501812711042.jpg"
        subscribeUrl="https://raw.githubusercontent.com/xm2017/xmfast/master/demo/siteApp191ysw.html"/>

  <rule type="101" typeOnclickAction="" subTypeName="电影" jsMethod="list();"
        url="http://m.191ysw.com/index.php?s=/vod-type-id-1-type--area--year--star--state--order-hits-p-%count%.html"
        currentPageCountHolder="%count%"
        searchKeywordHolder="">
    <script>
      function list() {
        var datalist = $("ul.list-unstyled.vod-item-img.ff-img-140 li").toArray();
        if (datalist.length == 0) {
          var response = {"code": "200", "msg": "suc", "content": ""};
          return response;
        }
        var tmparray = new Array();
        for (var i = 0; i < datalist.length; i++) {
          var href = datalist[i].getElementsByTagName("a")[0].href;
          var title = datalist[i].getElementsByTagName("img")[0].alt;
          var imgurl = datalist[i].getElementsByTagName("img")[0].getAttribute("data-original");
          var content = datalist[i].getElementsByTagName("img")[0].alt;
          var obj = {"title": title, "detailUrl": href, "posterUrl": imgurl, "content": content};
          tmparray.push(obj);
        }
        var response = {"code": "200", "msg": "suc", "content": tmparray};
        return response;
      }
    </script>

  </rule>

  <rule type="101" typeOnclickAction="" subTypeName="追剧" jsMethod="list();"
        url="http://m.191ysw.com/index.php?s=/vod-type-id-2-type--area--year--star--state--order-addtime-p-%count%.html"
        currentPageCountHolder="%count%"
        searchKeywordHolder="">
    <script>
      function list() {
        var datalist = $("ul.list-unstyled.vod-item-img.ff-img-140 li").toArray();

        if (datalist.length == 0) {
          var response = {"code": "200", "msg": "suc", "content": ""};
          return response;
        }
        var tmparray = new Array();
        for (var i = 0; i < datalist.length; i++) {
          var href = datalist[i].getElementsByTagName("a")[0].href;
          var title = datalist[i].getElementsByTagName("img")[0].alt;
          var imgurl = datalist[i].getElementsByTagName("img")[0].getAttribute("data-original");
          var content = datalist[i].getElementsByTagName("img")[0].alt;
          var obj = {"title": title, "detailUrl": href, "posterUrl": imgurl, "content": content};
          tmparray.push(obj);
        }
        var response = {"code": "200", "msg": "suc", "content": tmparray};
        return response;
      }
    </script>
  </rule>

  <rule type="101" typeOnclickAction="" subTypeName="动漫" jsMethod="list();"
        url="http://m.191ysw.com/index.php?s=/vod-type-id-3-type--area--year--star--state--order-addtime-p-%count%.html"
        currentPageCountHolder="%count%"
        searchKeywordHolder="">
    <script>
      function list() {
        var datalist = $("ul.list-unstyled.vod-item-img.ff-img-140 li").toArray();

        if (datalist.length == 0) {
          var response = {"code": "200", "msg": "suc", "content": ""};
          return response;
        }
        var tmparray = new Array();
        for (var i = 0; i < datalist.length; i++) {
          var href = datalist[i].getElementsByTagName("a")[0].href;
          var title = datalist[i].getElementsByTagName("img")[0].alt;
          var imgurl = datalist[i].getElementsByTagName("img")[0].getAttribute("data-original");
          var content = datalist[i].getElementsByTagName("img")[0].alt;
          var obj = {"title": title, "detailUrl": href, "posterUrl": imgurl, "content": content};
          tmparray.push(obj);
        }
        var response = {"code": "200", "msg": "suc", "content": tmparray};
        return response;
      }
    </script>

  </rule>

  <rule type="101" typeOnclickAction="" subTypeName="综艺" jsMethod="list();"
        url="http://m.191ysw.com/index.php?s=/vod-type-id-4-type--area--year--star--state--order-addtime-p-%count%.html"
        currentPageCountHolder="%count%"
        searchKeywordHolder="">
    <script>
      function list() {
        var datalist = $("ul.list-unstyled.vod-item-img.ff-img-140 li").toArray();

        if (datalist.length == 0) {
          var response = {"code": "200", "msg": "suc", "content": ""};
          return response;
        }
        var tmparray = new Array();
        for (var i = 0; i < datalist.length; i++) {
          var href = datalist[i].getElementsByTagName("a")[0].href;
          var title = datalist[i].getElementsByTagName("img")[0].alt;
          var imgurl = datalist[i].getElementsByTagName("img")[0].getAttribute("data-original");
          var content = datalist[i].getElementsByTagName("img")[0].alt;
          var obj = {"title": title, "detailUrl": href, "posterUrl": imgurl, "content": content};
          tmparray.push(obj);
        }
        var response = {"code": "200", "msg": "suc", "content": tmparray};
        return response;
      }
    </script>

  </rule>

  <rule type="102" jsMethod="detail();">
    <script>

      function detail() {
        var host = "http://m.191ysw.com";
        var posterUrl = $("img.media-object.img-thumbnail.ff-img:first").attr("data-original");
        var pageTitle = $("img.media-object.img-thumbnail.ff-img:first").attr("alt");
        var allText = $("[name='description']:first").attr("content").trim().replace(" ", "").replace("\n", "");
        var shortText = allText.substring(0, allText.length > 200 ? 200 : allText.length).trim();

        var actor;
        var actorTitle = $("div.media-body dt").toArray();
        var actorText = $("div.media-body dd").toArray();
        for (var i = 0; i < actorTitle.length; i++) {
          var stTmp;
          stTmp = actorTitle[i].innerHTML;
          if (stTmp.indexOf("主演") != -1) {
            continue;
          }
          var stDetail = actorText[i].getElementsByTagName("a");
          for (var j = 0; j < stDetail.length; j++) {
            var stDetailTmp = stDetail[j].innerHTML;
            stTmp = stTmp + " " + stDetailTmp;
          }
          actor = actor + "<br>" + stTmp;
        }

        var allDownList = new Array();
        var allDownTitleTmp = $("ul.dropdown-menu a").toArray();
        var allDownListTmp = $("div.tab-content.ff-playurl-dropdown ul").toArray();
        for (var i = 0; i < allDownListTmp.length; i++) {
          var titleSort = allDownTitleTmp[i].innerHTML;
          var downloadTmp = allDownListTmp[i].getElementsByTagName("li");
          var oneDownList = new Array();
          for (var j = 0; j < downloadTmp.length; j++) {
            var href = host + downloadTmp[j].getElementsByTagName("a")[0].getAttribute("href");
            var title = downloadTmp[j].getElementsByTagName("a")[0].innerHTML;
            var downloadBean = {"name": title, "href": href};
            oneDownList.push(downloadBean);
          }
          var pageDetail = {"title": titleSort, "downlistInfos": oneDownList};
          allDownList.push(pageDetail);
        }

        var pageInfo = {
          "posterUrl": posterUrl,
          "title": pageTitle.replace("免费观看", ""),
          "allText": allText,
          "shortText": shortText,
          "summary": actor.replace("undefined", ""),
          "downlist": allDownList
        };
        var response = {"code": "200", "msg": "suc", "content": pageInfo};
        return response;
      }

    </script>
  </rule>

  <rule type="103" typeOnclickAction="" subTypeName="" jsMethod="search();"
        url="http://m.191ysw.com/index.php?s=/vod-search-name-%keyword%-p-%count%.html"
        currentPageCountHolder="%count%"
        searchKeywordHolder="%keyword%">
    <script>
      function search() {
        var datalist = $("ul.list-unstyled.vod-item-img.ff-img-140 li").toArray();

        if (datalist.length == 0) {
          var response = {"code": "200", "msg": "suc", "content": ""};
          return response;
        }
        var tmparray = new Array();
        for (var i = 0; i < datalist.length; i++) {
          var href = datalist[i].getElementsByTagName("a")[0].href;
          var title = datalist[i].getElementsByTagName("img")[0].alt;
          var imgurl = datalist[i].getElementsByTagName("img")[0].getAttribute("data-original");
          var content = datalist[i].getElementsByTagName("img")[0].alt;
          var obj = {"title": title, "detailUrl": href, "posterUrl": imgurl, "content": content};
          tmparray.push(obj);
        }
        var response = {"code": "200", "msg": "suc", "content": JSON.stringify(tmparray)};
        return response;
      }
    </script>
  </rule>


</site>

  

